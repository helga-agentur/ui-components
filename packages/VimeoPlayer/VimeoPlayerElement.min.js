!function(){"use strict";var e=e=>{if(!e.every((e=>e.name)))throw new Error(`canReadAttribute: Every config entry must be an object with property name; you passed ${JSON.stringify(e)} instead.`);return{readAttributes(){e.forEach((e=>{const{name:t,validate:i,property:r,transform:n}=e,a=this.getAttribute(t);if("function"==typeof i&&!i(a))throw new Error(`canWatchAttribute: Attribute ${t} does not match validation rules`);const o=n||(e=>e);this[r||t]=o(a)}))}}};class t extends HTMLElement{baseURL="https://player.vimeo.com/video/";allow=["autoplay","fullscreen"];parameters={autoplay:"true",muted:"true"};attributes='width="640" height="360" frameborder="0" allowfullscreen';originalContent=null;constructor(){super(),Object.assign(this,e([{name:"data-video-id",validate:e=>!!e,property:"videoId"}])),this.readAttributes()}connectedCallback(){this.setupClickListener()}generateIFrameURL(){const e=new URLSearchParams(this.parameters);return`<iframe src="${this.baseURL}${this.videoId}?${e}" allow="${this.allow.join(";")}" ${this.attributes}></iframe>`}setupClickListener(){this.addEventListener("click",this.insertVideo.bind(this))}restore(){if(!this.originalContent)throw new Error("VimeoPlayer: this.originalContent is not set; make sure you only restore the original content after the video was dispalyed.");this.innerHTML=this.originalContent,this.originalContent=null}insertVideo(){this.orignalContent||(this.originalContent=this.innerHTML,this.innerHTML=this.generateIFrameURL(),this.unmute())}async unmute(){const e=this.querySelector("iframe");if(!e)throw new Error(`VimeoPlayer: IFrame not found in content, is ${this.innerHTML}`);this.vimeoPlayerPromise=(async()=>{const e="https://player.vimeo.com/api/player.js";if(window.Vimeo&&window.Vimeo.Player)return Promise.resolve(window.Vimeo.Player);let t=document.querySelector(`script[src="${e}"]`);return new Promise(((i,r)=>{t||(t=document.createElement("script")),t.addEventListener("load",(()=>i(window.Vimeo.Player))),t.addEventListener("error",(()=>r(new Error("Vimeo script could not be loaded")))),t.closest("body")||(t.setAttribute("src",e),document.body.appendChild(t))}))})();const t=await this.vimeoPlayerPromise;this.player=new t(e),await this.player.ready(),await new Promise((e=>this.player.on("timeupdate",e))),await this.player.setVolume(1),await new Promise((e=>setTimeout(e,0)));await this.player.getPaused()&&(await this.player.setVolume(0),await this.player.play())}}window.customElements.get("vimeo-player")||window.customElements.define("vimeo-player",t)}();
